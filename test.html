<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Browse</title>
  <style>
        @import url("https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap");
        @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap");
      
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          border: none;
          box-shadow: none;
          outline: none;
          font-family: "Poppins", sans-serif;
        }
      .link{
        text-decoration: none;
      }
        button {
          cursor: pointer;
        }
      
        body {
          background-color: #111827;
        }
       .nav{
  position: fixed;
  top: 0;
  display: flex;
  justify-content: space-around;
  width: 100%;
  height: 100px;
  line-height: 100px;
  background: #111827;
  z-index: 100;
  }
  .nav-logo {
  font-size: 1.8rem;
  padding-left: 20px;
  }
  .nav h1{
   
    color: white;
    font-weight: 100;
    font-family: "Black Ops One";
    padding-bottom: 5rem;
  }
  
  .nav-menu ul{
  display: inline-flex;
  }
  .nav-menu ul li{
    display: block;
  list-style-type: none;
  }
  .nav-menu ul li .link{
  text-decoration: none;
  font-weight: 500;
  color: #fff;
  padding-bottom: 15px;
  margin: 0 25px;
  }
  .link:hover, .active{
  border-bottom: 2px solid #fff;
  }
  .nav h1 span {
    color: #0ea5e9;
    font-family: "Black Ops One";
  }
.dropdown-btn {
  display: none;
}

@media (max-width: 800px) {
  .nav {
      justify-content: space-between;
  }

  .nav-menu {
      display: none;
  }

  .dropdown-btn {
      display: block;
      font-size: 1.5rem; 
      color: white;
      margin-right: 20px; 
      cursor: pointer;
  }

  .dropdown-btn:hover {
      color: #0ea5e9;
  }

  .nav-menu.active {
      display: flex; 
      flex-direction: column; 
      position: absolute; 
      top: 100px; 
      left: 0;
      width: 100%;
      background: #111827;
      text-align: center; 
  }

  .nav-menu.active ul {
      margin: 0;
      padding: 0;
  }

  .nav-menu.active ul li {
      margin: 20px 0; 
  }

  .nav-menu.active ul li .link {
      padding-bottom: 0; 
  }
}

        main {
          margin: 10px 16px;
          padding: 40px 0;
          display: flex;
          flex-direction: column;
          gap: 40px;
        }
        .app-list {
            display: grid; 
            grid-template-columns: repeat(3, minmax(250px, 300px));
            gap: 20px; 
          }
        header {
          display: flex;
          justify-content: center;
          align-items: center;
          align-self: stretch;
        }
      
        header h1 {
          color: #e5e7eb;
          font-family: "Black Ops One";
          font-size: 40px;
          font-style: normal;
          font-weight: 400;
          line-height: normal;
          position: relative;
        }
      
        .content,
        app-list {
          display: grid;
          grid-template-columns: repeat(Auto-fill, minmax(250px, 1fr));
          gap: 40px;
        }
        @media (min-width: 375px) {
        }
      
        
        @media (min-width: 744px) {
          main {
            margin: 0 80px;
          }
        }
    
        @media (min-width: 1440px) {
          main {
            margin: 0 160px;
          }
        }
      
        .input-group {
          display: flex;
          padding: 12px 16px;
          justify-content: center;
          align-items: flex-start;
          flex: 1 0 0;
          border-radius: 8px;
          background: #1f2937;
          align-items: flex-start;
          gap: 8px;
          width: 100%;
        }
      
        .input-group svg {
          width: 24px;
          height: 24px;
          fill: #e5e7eb;
        }
      
        .input-group input {
          color: #e5e7eb;
          font-family: Poppins;
          font-size: 16px;
          font-style: normal;
          font-weight: 600;
          line-height: 24px;
          width: 100%;
          background: transparent;
          border: 1px solid #4b5563; 
          border-radius: 6px; 
          padding: 8px; 
        }
      
        .list-title {
          color: #e5e7eb;
          font-family: Poppins;
          font-size: 24px;
          font-style: normal;
          font-weight: 700;
          line-height: 32px;
        }
      
        .game-card {
          background-color: #374151; 
          border-radius: 8px; 
          overflow: hidden; 
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); 
        }
      
        .game-card img {
          width: 100%; 
          height: 200px; 
          object-fit: cover; 
        }
      
        .game-info {
          padding: 16px; 
        }
      
        .game-info h3 {
          color: #e5e7eb;
          font-size: 18px;
          margin-bottom: 8px; 
        }
      
        .game-info p {
          color: #9ca3af; 
          font-size: 14px; 
          margin-bottom: 4px; 
        }
      
        .game-info p:last-child {
          margin-bottom: 0; 
        }
      
        .more-loader {
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
        }
      
        .more-loader::after {
          content: "";
          width: 32px;
          height: 32px;
          border-radius: 50%;
          border: 5px solid #e5e7eb;
          border-bottom-color: transparent;
          animation: spin 1s linear infinite;
        }
      
        @keyframes spin {
          0% {
            transform: rotate(0deg);
          }
          100% {
            transform: rotate(360deg);
          }
        }
      
        .more-loader.loaded {
          opacity: 0;
          visibility: hidden;
          pointer-events: none;
        }
      
        @media (min-width: 375px) {
        }
      
        @media (min-width: 744px) {
          .game-list {
            columns: 2;
            column-gap: 16px;
          }
        }
        @media (min-width: 1440px) {
          .game-list {
            columns: 4;
            column-gap: 32px;
          }
        }
      
        .loader {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          background-color: rgba(0, 0, 0, 0.5);
          z-index: 999;
        }
      
        .loader img {
          width: 100px;
          height: auto;
        }
      </style>
      
  
</head>
<body>
  <nav class="nav">
    <div class="nav-logo">
        <h1>Genre<span>Quest</span></h1>
    </div>
    <div class="dropdown-btn" onclick="toggleMenu()">â˜°</div>
    <div class="nav-menu" id="navMenu">
        <ul>
            <li><a href="GQhome.html" class="link">Home</a></li>
            <li><a href="index.html" class="link">Top100</a></li>
            <li><a href="test.html" class="link active">Browse</a></li>
            <li><a href="Forum.html" class="link">Forum</a></li>
            <li><a href="GQlogin.html" class="link">Login</a></li>
        </ul>
    </div>
</nav>
  <header>
    <h1>Genre<span>Quest</span></h1>
  </header>
  <main>
    <div class="input-group">
      
      <input type="text" placeholder="Search for a game" id="searchInput" />
    </div>
    <app-list></app-list>
  </main>
  <script>
    // JavaScript code here
    class Game {
      constructor(id, name, released, backgroundImage, rating, platforms) {
        this.id = id;
        this.name = name;
        this.released = released;
        this.backgroundImage = backgroundImage;
        this.rating = rating;
        this.platforms = platforms;
      }
    }

    const APIKEY = "bdcc4010f2ab48e884c08d2e73080f9e";
    const DATES = "2022-01-01,2023-11-01";
    const ORDERING = "-added";

    const url = `https://api.rawg.io/api/games?key=${APIKEY}&dates=${DATES}&ordering=${ORDERING}`;
    const platformsParentsUrl = `https://api.rawg.io/api/platforms/lists/parents?key=${APIKEY}&dates=${DATES}&ordering=${ORDERING}`;
    const searchUrl = (query) =>
      `https://api.rawg.io/api/games?key=${APIKEY}&dates=${DATES}&ordering=${ORDERING}&search=${query}`;

    const formatDate = (inputDate) => {
      // Implementation of formatDate function
      const date = new Date(inputDate);
      return `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()}`;
    };

    const eventBus = new class {
      // Implementation of EventBus
      constructor() {
        this.listeners = {};
      }

      on(event, callback) {
        if (!this.listeners[event]) {
          this.listeners[event] = [];
        }
        this.listeners[event].push(callback);
      }

      emit(event, data) {
        const eventListeners = this.listeners[event];
        if (eventListeners) {
          eventListeners.forEach((listener) => listener(data));
        }
      }
    }();

    const gameService = new (class {
      // Implementation of GameService
      constructor() {
        this.games = [];
        this.loadMore = true;
        this.loading = false;
      }

      async fetchGames() {
        this.loading = true;
        const response = await fetch(url);
        const data = await response.json();
        this.games = data.results.map((result) => new Game(
          result.id,
          result.name,
          result.released,
          result.background_image,
          result.rating,
          result.platforms.map(platform => platform.platform.name)
        ));
        this.loading = false;
        eventBus.emit("gamesLoaded", this.games);
      }

      async searchGames(query) {
        this.loading = true;
        const response = await fetch(searchUrl(query));
        const data = await response.json();
        this.games = data.results.map((result) => new Game(
          result.id,
          result.name,
          result.released,
          result.background_image,
          result.rating,
          result.platforms.map(platform => platform.platform.name)
        ));
        this.loading = false;
        eventBus.emit("gamesLoaded", this.games);
      }

      async fetchMoreGames() {
        if (!this.loadMore || this.loading) return;
        this.loading = true;
        const response = await fetch(url + `&page=${Math.floor(this.games.length / 20) + 1}`);
        const data = await response.json();
        if (data.results.length === 0) {
          this.loadMore = false;
          return;
        }
        const newGames = data.results.map((result) => new Game(
          result.id,
          result.name,
          result.released,
          result.background_image,
          result.rating,
          result.platforms.map(platform => platform.platform.name)
        ));
        this.games = [...this.games, ...newGames];
        this.loading = false;
        eventBus.emit("gamesLoaded", this.games);
      }
    })();
    
    const input = document.getElementById("searchInput");
    input.addEventListener("input", () => {
      const query = input.value.trim();
      if (query) {
        gameService.searchGames(query);
      } else {
        gameService.fetchGames();
      }
    });

    eventBus.on("gamesLoaded", (games) => {
      const appList = document.querySelector("app-list");
      appList.innerHTML = "";
      games.forEach((game) => {
        const gameElement = document.createElement("div");
        gameElement.innerHTML = `
         <a href="gamepage.html?gameId=${game.id}" class="link"> <div class="game-card">
            <img src="${game.backgroundImage}" alt="${game.name}" />
            <div class="game-info">
              <h3>${game.name}</h3>
              <p>Released: ${formatDate(game.released)}</p>
              <p>Rating: ${game.rating}</p>
              <p>Platforms: ${game.platforms.join(", ")}</p>
            </div>
          </div></a>
        `;
        appList.appendChild(gameElement);
      });
    });

    window.addEventListener("scroll", () => {
      const { scrollTop, clientHeight, scrollHeight } = document.documentElement;
      if (scrollHeight - scrollTop === clientHeight) {
        gameService.fetchMoreGames();
      }
    });

    window.addEventListener("DOMContentLoaded", () => {
      gameService.fetchGames();
    });
  </script>
  <script>function toggleMenu() {
    var navMenu = document.getElementById("navMenu");
    navMenu.classList.toggle("active");
}</script>
</body>
</html>
